import { PrismaClient } from '@prisma/client';
import bcrypt from 'bcrypt';

const prisma = new PrismaClient();

const stressQuestions = [
  { event: "D√©c√®s du conjoint", points: 100 },
  { event: "Divorce", points: 73 },
  { event: "S√©paration conjugale", points: 65 },
  { event: "Emprisonnement", points: 63 },
  { event: "D√©c√®s d'un proche parent", points: 63 },
  { event: "Blessure ou maladie personnelle", points: 53 },
  { event: "Mariage", points: 50 },
  { event: "Licenciement", points: 47 },
  { event: "R√©conciliation conjugale", points: 45 },
  { event: "Retraite", points: 45 },
  { event: "Changement de sant√© d'un membre de la famille", points: 44 },
  { event: "Grossesse", points: 40 },
  { event: "Difficult√©s sexuelles", points: 39 },
  { event: "Arriv√©e d'un nouveau membre dans la famille", points: 39 },
  { event: "R√©organisation professionnelle", points: 39 },
  { event: "Changement de situation financi√®re", points: 38 },
  { event: "D√©c√®s d'un ami proche", points: 37 },
  { event: "Changement de type de travail", points: 36 },
  { event: "Changement dans le nombre de disputes conjugales", points: 35 },
  { event: "Hypoth√®que importante", points: 31 },
  { event: "Saisie d'hypoth√®que ou de pr√™t", points: 30 },
  { event: "Changement de responsabilit√©s au travail", points: 29 },
  { event: "D√©part d'un enfant du foyer", points: 29 },
  { event: "Probl√®mes avec la belle-famille", points: 29 },
  { event: "R√©ussite personnelle exceptionnelle", points: 28 },
  { event: "Conjoint commen√ßant ou arr√™tant de travailler", points: 26 },
  { event: "D√©but ou fin d'√©tudes", points: 26 },
  { event: "Changement de conditions de vie", points: 25 },
  { event: "R√©vision des habitudes personnelles", points: 24 },
  { event: "Difficult√©s avec son sup√©rieur", points: 23 },
  { event: "Changement d'horaires ou de conditions de travail", points: 20 },
  { event: "D√©m√©nagement", points: 20 },
  { event: "Changement d'√©cole", points: 20 },
  { event: "Changement de loisirs", points: 19 },
  { event: "Changement dans les activit√©s religieuses", points: 19 },
  { event: "Changement dans les activit√©s sociales", points: 18 },
  { event: "Petit cr√©dit ou pr√™t", points: 17 },
  { event: "Changement dans les habitudes de sommeil", points: 16 },
  { event: "Changement dans les r√©unions de famille", points: 15 },
  { event: "Changement dans les habitudes alimentaires", points: 15 },
  { event: "Vacances", points: 13 },
  { event: "F√™tes de fin d'ann√©e", points: 12 },
  { event: "Petite infraction √† la loi", points: 11 }
];

const activities = [
  // Activit√©s de Bien-√™tre
  {
    title: "M√©ditation Zen",
    description: "Une s√©ance de m√©ditation guid√©e pour apaiser l'esprit et r√©duire le stress. Apprenez des techniques de respiration et de pleine conscience.",
    category: "BIEN_ETRE",
    duration: "30 minutes",
    level: "Tous niveaux",
    location: "Studio de m√©ditation",
    equipment: "Tapis de yoga, coussin de m√©ditation",
    isActive: true
  },
  {
    title: "Yoga Flow",
    description: "Une s√©ance dynamique de yoga qui combine postures et respiration pour am√©liorer la flexibilit√© et la force.",
    category: "BIEN_ETRE",
    duration: "1 heure",
    level: "Interm√©diaire",
    location: "Salle de yoga",
    equipment: "Tapis de yoga, briques de yoga",
    isActive: true
  },
  {
    title: "Massage Th√©rapeutique",
    description: "S√©ance de massage relaxant pour soulager les tensions musculaires et am√©liorer la circulation sanguine.",
    category: "BIEN_ETRE",
    duration: "1 heure",
    level: "Tous niveaux",
    location: "Cabinet de massage",
    equipment: "Huile de massage",
    isActive: true
  },

  // Activit√©s Sportives
  {
    title: "Course √† Pied en Nature",
    description: "Parcours de course √† pied dans des sentiers naturels pour am√©liorer l'endurance tout en profitant du paysage.",
    category: "SPORT",
    duration: "45 minutes",
    level: "Interm√©diaire",
    location: "Parc naturel",
    equipment: "Chaussures de course, bouteille d'eau",
    isActive: true
  },
  {
    title: "Natation Relaxante",
    description: "S√©ance de natation √† rythme mod√©r√© pour travailler l'ensemble du corps tout en douceur.",
    category: "SPORT",
    duration: "1 heure",
    level: "Tous niveaux",
    location: "Piscine",
    equipment: "Maillot de bain, bonnet de bain",
    isActive: true
  },
  {
    title: "Pilates",
    description: "Cours de Pilates pour renforcer les muscles profonds et am√©liorer la posture.",
    category: "SPORT",
    duration: "1 heure",
    level: "D√©butant",
    location: "Salle de Pilates",
    equipment: "Tapis de Pilates",
    isActive: true
  },

  // Activit√©s Cr√©atives
  {
    title: "Atelier de Peinture",
    description: "Exprimez votre cr√©ativit√© √† travers la peinture. Apprenez diff√©rentes techniques et cr√©ez votre propre ≈ìuvre d'art.",
    category: "ART",
    duration: "2 heures",
    level: "Tous niveaux",
    location: "Atelier d'art",
    equipment: "Pinceaux, peintures, toile",
    isActive: true
  },
  {
    title: "Cours de Photographie",
    description: "Apprenez les bases de la photographie et capturez des moments uniques avec votre appareil photo.",
    category: "ART",
    duration: "2 heures",
    level: "D√©butant",
    location: "Studio photo",
    equipment: "Appareil photo",
    isActive: true
  },
  {
    title: "Atelier d'√âcriture",
    description: "Stimulez votre cr√©ativit√© litt√©raire √† travers des exercices d'√©criture et des discussions en groupe.",
    category: "ART",
    duration: "1h30",
    level: "Tous niveaux",
    location: "Biblioth√®que",
    equipment: "Cahier et stylo",
    isActive: true
  },

  // Activit√©s de Pleine Nature
  {
    title: "Randonn√©e en Montagne",
    description: "D√©couvrez des sentiers de montagne magnifiques lors d'une randonn√©e guid√©e.",
    category: "AVENTURE",
    duration: "4 heures",
    level: "Avanc√©",
    location: "Massif montagneux",
    equipment: "Chaussures de randonn√©e, b√¢tons, sac √† dos",
    isActive: true
  },
  {
    title: "V√©lo en For√™t",
    description: "Parcours de v√©lo sur des chemins forestiers pour une exp√©rience nature et sportive.",
    category: "AVENTURE",
    duration: "2 heures",
    level: "Interm√©diaire",
    location: "For√™t",
    equipment: "V√©lo tout-terrain, casque",
    isActive: true
  },
  {
    title: "Cano√´-Kayak",
    description: "D√©couvrez les rivi√®res et lacs lors d'une sortie en cano√´-kayak guid√©e.",
    category: "AVENTURE",
    duration: "3 heures",
    level: "Interm√©diaire",
    location: "Rivi√®re",
    equipment: "Cano√´/kayak, gilet de sauvetage",
    isActive: true
  },

  // Activit√©s de Relaxation
  {
    title: "Tai Chi",
    description: "Pratiquez le Tai Chi pour am√©liorer votre √©quilibre et votre bien-√™tre g√©n√©ral.",
    category: "BIEN_ETRE",
    duration: "1 heure",
    level: "Tous niveaux",
    location: "Parc",
    equipment: "Tenue confortable",
    isActive: true
  },
  {
    title: "Sophrologie",
    description: "S√©ance de sophrologie pour apprendre √† g√©rer le stress et les √©motions.",
    category: "BIEN_ETRE",
    duration: "45 minutes",
    level: "Tous niveaux",
    location: "Centre de sophrologie",
    equipment: "Aucun",
    isActive: true
  },
  {
    title: "Qi Gong",
    description: "Pratiquez le Qi Gong pour harmoniser votre √©nergie vitale et am√©liorer votre sant√©.",
    category: "BIEN_ETRE",
    duration: "1 heure",
    level: "Tous niveaux",
    location: "Salle de Qi Gong",
    equipment: "Tenue confortable",
    isActive: true
  }
];

// Types d'√©motions secondaires
const secondaryEmotions: { [key: string]: string[] } = {
  "Joie": ["Amusement", "Fiert√©", "Optimisme", "Enthousiasme", "Soulagement", "Contentement"],
  "Tristesse": ["M√©lancolie", "Nostalgie", "D√©ception", "Chagrin", "Solitude", "Regret"],
  "Col√®re": ["Frustration", "Irritation", "Agacement", "Rage", "Indignation", "Exasp√©ration"],
  "Peur": ["Anxi√©t√©", "Inqui√©tude", "Stress", "Panique", "Appr√©hension", "Nervosit√©"],
  "Surprise": ["√âtonnement", "Stup√©faction", "√âmerveillement", "Confusion", "Perplexit√©", "Choc"],
  "D√©go√ªt": ["Aversion", "R√©pulsion", "√âc≈ìurement", "M√©pris", "R√©pugnance", "Rejet"]
};

// Types d'√©motions principales
const primaryEmotions = [
  { name: "Joie", level: 1, color: "border-yellow-500", bgColor: "bg-yellow-50" },
  { name: "Tristesse", level: 1, color: "border-blue-500", bgColor: "bg-blue-50" },
  { name: "Col√®re", level: 1, color: "border-red-500", bgColor: "bg-red-50" },
  { name: "Peur", level: 1, color: "border-purple-500", bgColor: "bg-purple-50" },
  { name: "Surprise", level: 1, color: "border-orange-500", bgColor: "bg-orange-50" },
  { name: "D√©go√ªt", level: 1, color: "border-green-500", bgColor: "bg-green-50" }
];

// Cr√©ation de l'utilisateur admin
const createAdminUser = async () => {
  const hashedPassword = await bcrypt.hash('admin123', 10);
  const admin = await prisma.user.upsert({
    where: { email: 'admin@cesizen.com' },
    update: {},
    create: {
      email: 'admin@cesizen.com',
      password: hashedPassword,
      name: 'Admin',
      role: 'ADMIN'
    }
  });
  console.log('‚úÖ Utilisateur admin cr√©√©');
  return admin;
};

async function main() {
  console.log('üå± D√©but du seeding...');

  // Nettoyage des tables
  await prisma.favorite.deleteMany();
  await prisma.activity.deleteMany();
  await prisma.stressQuestion.deleteMany();
  await prisma.userEmotion.deleteMany();
  await prisma.emotionType.deleteMany();
  await prisma.user.deleteMany();

  // Cr√©ation de l'utilisateur admin
  await createAdminUser();

  // Cr√©ation des questions de stress
  for (const question of stressQuestions) {
    const created = await prisma.stressQuestion.create({
      data: question
    });
    console.log(`‚úÖ Question de stress cr√©√©e : ${created.event}`);
  }

  // Cr√©ation des activit√©s
  for (const activity of activities) {
    const created = await prisma.activity.create({
      data: activity
    });
    console.log(`‚úÖ Activit√© cr√©√©e : ${created.title}`);
  }

  // Cr√©ation des types d'√©motions principales et secondaires
  const emotionTypes = [];
  for (const emotion of primaryEmotions) {
    const created = await prisma.emotionType.create({ data: emotion });
    console.log(`Emotion principale cr√©√©e : ${created.name}`);
    emotionTypes.push(created);

    // Cr√©ation des √©motions secondaires associ√©es
    const secondaryList = secondaryEmotions[emotion.name];
    for (const secondaryName of secondaryList) {
      const secondaryEmotion = await prisma.emotionType.create({
        data: {
          name: secondaryName,
          level: 2,
          parentId: created.id
        }
      });
      console.log(`  ‚îî‚îÄ Emotion secondaire cr√©√©e : ${secondaryEmotion.name}`);
    }
  }

  console.log('üå± Seeding termin√© !');
}

main()
  .catch((e) => {
    console.error('‚ùå Erreur lors du seeding :', e);
    process.exit(1);
  })
  .finally(async () => {
    await prisma.$disconnect();
  });
